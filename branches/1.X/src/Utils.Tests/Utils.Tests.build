<?xml version="1.0" encoding="utf-8" ?>
<project name="Utils.Tests" default="rebuild" 
    xmlns="http://nant.sf.net/release/0.85-rc1/nant.xsd">

    <property name="src.dir" value="."/>
    <property name="lib.dir" value="../lib"/>
    <property name="warninglevel" value="/warn:3"/>

    <target name="rebuild">
        <call target="clean"/>
        <call target="build"/>
    </target>

    <target name="clean">
        <delete dir="build-Release" verbose="${verbose}" failonerror="false" />
        <delete dir="build-Debug" verbose="${verbose}" failonerror="false" />
    </target>

    <target name="init">
        <mkdir dir="${build.dir}"/>
    </target>

    <target name="build">
        <call target="compile"/>
    </target>

    <target name="resources" depends="init">
    </target>

    <target name="compile" depends="init">
        <property name="define" value="TRACE"/>
        <property name="define" value="DEBUG;${define}" if="${debug}"/>
        <property name="define" value="ALT_ADMIN_DIR;${define}" if="${alt.admin.dir}"/>

        <echo message="${lib.dir}/nunit.framework.dll"/>

        <csc target="library" output="${build.dir}/Utils.Tests.dll" 
            verbose="${verbose}" define="${define}" debug="${debug}">
            
            <references>
                <include name="..\Utils\${build.dir}\Utils.dll"/>
                <include name="${lib.dir}\nunit.framework.dll"/>
            </references>
            
            <sources basedir="${src.dir}">
                <include name="**/*.cs"/>
            </sources>
            
            <arg value="/debug:pdbonly" unless="${debug}"/>
            <arg value="${warninglevel}"/>
        </csc>

    </target>
</project> 
