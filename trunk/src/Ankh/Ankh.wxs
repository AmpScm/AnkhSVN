<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
  <Fragment Id="FR_Ankh">
    <DirectoryRef Id="TARGETDIR">
      <!-- RegAsm reg settings -->
      <Component Id="C_Ankh_RegAsm" DiskId="1" Guid="FE524A94-5C69-4792-8B13-ABE0A8171FCF">
        <ProgId Id="Ankh" Description="Ankh.Connect"/>
        <!--Registry Id="Ankh_registry8" Root="HKCR" Type="string" KeyPath="yes"
          Key="Ankh" 
          Value="Ankh.Connect" /-->
        <Registry Id="Ankh_registry9" Root="HKCR" Type="string"
          Key="Ankh\CLSID" 
          Value="{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}" />
        <Registry Id="Ankh_registry10" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}" 
          Value="Ankh.Connect" />
        <Registry Id="Ankh_registry11" Root="HKCR"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\Implemented Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" />
        <Registry Id="Ankh_registry12" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Value="mscoree.dll" />
        <Registry Id="Ankh_registry13" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="ThreadingModel" Value="Both" />
        <Registry Id="Ankh_registry14" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="Class" Value="Ankh.Connect" />
        <Registry Id="Ankh_registry15" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="Assembly" Value="Ankh, Version=$(var.ankhversion), Culture=neutral, PublicKeyToken=null" />
        <Registry Id="Ankh_registry16" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="RuntimeVersion" Value="v1.0.3705" />
        <Registry Id="Ankh_registry17" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="CodeBase" Value="[TARGETDIR]Ankh.dll" />
        <Registry Id="Ankh_registry18" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32\$(var.ankhversion)" 
          Name="Class" Value="Ankh.Connect" />
        <Registry Id="Ankh_registry19" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32\$(var.ankhversion)" 
          Name="Assembly" Value="Ankh, Version=$(var.ankhversion), Culture=neutral, PublicKeyToken=null" />
        <Registry Id="Ankh_registry20" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32\$(var.ankhversion)" 
          Name="RuntimeVersion" Value="v1.0.3705" />
        <Registry Id="Ankh_registry21" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32\$(var.ankhversion)" 
          Name="CodeBase" Value="[TARGETDIR]Ankh.dll" />
        <Registry Id="Ankh_registry22" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\ProgId" 
          Value="Ankh" />
        <Registry Id="Ankh_registry23" Root="HKCR" Type="string"
          Key="Component Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" 
          Name="0" Value=".NET Category" />
      </Component>

      <!-- Visual Studio reg settings -->
      <Component Id="C_Ankh_RegVS" DiskId="1" Guid="A2040CBF-FBAF-41c1-AFC5-824E466BEBCE">
        <Registry KeyPath="yes" Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="SatelliteDllPath" Type="string" Value="[TARGETDIR]" 
          Id="_008A3D8ACC7C418BBA42A60F997428BF" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="LoadBehavior" Type="integer" Value="1" 
          Id="_352F2A9FD88540A99E7BAA10389BDEF7" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="CommandPreload" Type="integer" Value="1" 
          Id="_5B6D86B7749D43C7A89C4A4976E64241" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="AboutBoxIcon" Type="string" Value="[TARGETDIR]\1033\BitmapDll.dll,101"
          Id="_653330477C2B4294AEEDBA1C043EB41B" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="CommandLineSafe" Type="integer" Value="0"
          Id="_678D00950AB146CDA07C5E0DE1B72B20" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="Description" Type="string" Value="Subversion addin for Visual Studio .NET"
          Id="_7540CF47F42C43F59211F23BA3E49E8D" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="FriendlyName" Type="string" Value="AnkhSVN  Addin"
          Id="_7A53D8342A1745CCBDC537B2FE952D2A" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="SatelliteDllName" Type="string" Value="BitmapDll.dll"
          Id="_AA431B0DB49845CFB814442A956D875B" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="AboutBoxDetails" Type="string"
          Id="_CEF7FF5E3BFE43C6934EACE6A662811D" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="SatelliteDllPath" Type="string" Value="[TARGETDIR]"
          Id="_671746B8A40547A7A502F7D64CCBFE2E" />        
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="LoadBehavior" Type="integer" Value="1"
          Id="_EBDDF52053274EB8A6FC2795FC7BE6AE" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="CommandPreload" Type="integer" Value="1"
          Id="_3B7342E61FDC42EC81F9176F598E4C6A" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="AboutBoxIcon" Type="string" Id="_E6E61958F7774F41B43B3DAFBE68116D" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="CommandLineSafe" Type="integer" Value="0"
          Id="_57DAEBE95B4047FCAF9F5EE336AC61C4" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="Description" Type="string" Value="Subversion addin for Visual Studio .NET"
          Id="_EE3DA771810843CCB564B23198CBB53E" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="FriendlyName" Type="string" Value="AnkhSVN Addin"  
          Id="_8C17B03BE4F14CA496008D0798B5830C" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="SatelliteDllName" Type="string" Value="BitmapDll.dll"
          Id="_56557FC97236437087F1F4B72627B3D2" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="AboutBoxDetails" Type="string"
          Id="_8A2A6E99964F4519A46862AD81634E49" />
      </Component>
      <Component Id="C_Ankh_RegVS2005" DiskId="1" Guid="6D3470BB-C30A-4df2-909A-422EAFBED0BE">
        <Registry Root="HKMU" KeyPath="yes"
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="SatelliteDllPath" Type="string" Value="[TARGETDIR]" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="LoadBehavior" Type="integer" Value="1" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="CommandPreload" Type="integer" Value="1" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="AboutBoxIcon" Type="string" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="CommandLineSafe" Type="integer" Value="0" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="Description" Type="string" Value="Subversion addin for Visual Studio .NET" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="FriendlyName" Type="string" Value="AnkhSVN Addin" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="SatelliteDllName" Type="string" Value="BitmapDll.dll" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="AboutBoxDetails" Type="string" />
      </Component>
      

      <Component Id="C_Ankh.dll" DiskId="1" Guid="02BBB6F8-8035-421f-83EC-7CA51E05B981">
        <File Id="CF_Ankh.dll" Name="Ankh.dll"
          Checksum="yes" KeyPath="yes" Vital="yes" src="$(var.builddir)\Ankh.dll" />
        <File Id="CF_Ankh.pdb" Name="Ankh.pdb" Checksum="yes" Vital="yes" src="$(var.builddir)\Ankh.pdb" />
      </Component>

      <Directory Id="Ankh_directory1" Name="1033">
        <Component Id="C_Bitmap.dll" DiskId="1" Guid="7609179F-82F7-4659-A4F8-FF1FB0ABFE53">
          <File Id="Ankh_file3" KeyPath="yes" Name="BITMAP~1.DLL" LongName="BitmapDll.dll" Checksum="yes" Vital="yes" src="$(var.builddir)\..\1033\BitmapDll.dll" />
        </Component>
      </Directory>
    </DirectoryRef>
  </Fragment>
</Wix>
