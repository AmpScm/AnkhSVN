<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
  <Fragment>
  <ComponentGroup Id="CG_Ankh">
    <ComponentRef Id="C_Ankh_RegAsm" />
    <ComponentRef Id="C_Ankh_RegVS" />
    <ComponentRef Id="C_Ankh_RegVS2005" />
    <ComponentRef Id="C_Ankh.dll" />
    <ComponentRef Id="C_Bitmap.dll" />
  </ComponentGroup>
    <DirectoryRef Id="TARGETDIR">
      <!-- RegAsm reg settings -->
      <Component Id="C_Ankh_RegAsm" DiskId="1" Guid="FE524A94-5C69-4792-8B13-ABE0A8171FCF">
        <ProgId Id="Ankh" Description="Ankh.Connect"/>
        <!--Registry Id="Ankh_registry8" Root="HKCR" Type="string" KeyPath="yes"
          Key="Ankh" 
          Value="Ankh.Connect" /-->
        <Registry Id="Ankh_registry9" Root="HKCR" Type="string"
          Key="Ankh\CLSID" 
          Value="{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}" />
        <Registry Id="Ankh_registry10" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}" 
          Value="Ankh.Connect" />
        <Registry Id="Ankh_registry11" Root="HKCR"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\Implemented Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" />
        <Registry Id="Ankh_registry12" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Value="mscoree.dll" />
        <Registry Id="Ankh_registry13" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="ThreadingModel" Value="Both" />
        <Registry Id="Ankh_registry14" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="Class" Value="Ankh.Connect" />
        <Registry Id="Ankh_registry15" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="Assembly" Value="Ankh, Version=$(var.ankhversion), Culture=neutral, PublicKeyToken=null" />
        <Registry Id="Ankh_registry16" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="RuntimeVersion" Value="v1.0.3705" />
        <Registry Id="Ankh_registry17" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32" 
          Name="CodeBase" Value="[TARGETDIR]Ankh.dll" />
        <Registry Id="Ankh_registry18" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32\$(var.ankhversion)" 
          Name="Class" Value="Ankh.Connect" />
        <Registry Id="Ankh_registry19" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32\$(var.ankhversion)" 
          Name="Assembly" Value="Ankh, Version=$(var.ankhversion), Culture=neutral, PublicKeyToken=null" />
        <Registry Id="Ankh_registry20" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32\$(var.ankhversion)" 
          Name="RuntimeVersion" Value="v1.0.3705" />
        <Registry Id="Ankh_registry21" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\InprocServer32\$(var.ankhversion)" 
          Name="CodeBase" Value="[TARGETDIR]Ankh.dll" />
        <Registry Id="Ankh_registry22" Root="HKCR" Type="string"
          Key="CLSID\{DA979B20-78DF-45BC-A7D7-F5EF9DC77D30}\ProgId" 
          Value="Ankh" />
        <Registry Id="Ankh_registry23" Root="HKCR" Type="string"
          Key="Component Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" 
          Name="0" Value=".NET Category" />
      </Component>

      <!-- Visual Studio reg settings -->
      <Component Id="C_Ankh_RegVS" DiskId="1" Guid="A2040CBF-FBAF-41c1-AFC5-824E466BEBCE">
        <Registry KeyPath="yes" Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="SatelliteDllPath" Type="string" Value="[TARGETDIR]" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="LoadBehavior" Type="integer" Value="1" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="CommandPreload" Type="integer" Value="1" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="AboutBoxIcon" Type="string" Value="[TARGETDIR]\1033\BitmapDll.dll,101" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="CommandLineSafe" Type="integer" Value="0" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="Description" Type="string" Value="Subversion addin for Visual Studio .NET" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="FriendlyName" Type="string" Value="AnkhSvn  Addin" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="SatelliteDllName" Type="string" Value="BitmapDll.dll" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.0\AddIns\Ankh" 
          Name="AboutBoxDetails" Type="string" Value="$(var.aboutboxdetails)" />
				<Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="SatelliteDllPath" Type="string" Value="[TARGETDIR]" />
				<Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="LoadBehavior" Type="integer" Value="1" />
				<Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="CommandPreload" Type="integer" Value="1" />
				<Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="AboutBoxIcon" Type="string" />
				<Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="CommandLineSafe" Type="integer" Value="0" />
				<Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="Description" Type="string" Value="Subversion addin for Visual Studio .NET" />
				<Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="FriendlyName" Type="string" Value="AnkhSvn Addin" />
				<Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="SatelliteDllName" Type="string" Value="BitmapDll.dll" />
				<Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\7.1\AddIns\Ankh" 
          Name="AboutBoxDetails" Type="string" Value="$(var.aboutboxdetails)" />
      </Component>
      <Component Id="C_Ankh_RegVS2005" DiskId="1" Guid="6D3470BB-C30A-4df2-909A-422EAFBED0BE">
        <Registry Root="HKMU" KeyPath="yes"
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="SatelliteDllPath" Type="string" Value="[TARGETDIR]" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="LoadBehavior" Type="integer" Value="1" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="CommandPreload" Type="integer" Value="1" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="AboutBoxIcon" Type="string" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="CommandLineSafe" Type="integer" Value="0" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="Description" Type="string" Value="Subversion addin for Visual Studio .NET" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="FriendlyName" Type="string" Value="AnkhSvn Addin" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="SatelliteDllName" Type="string" Value="BitmapDll.dll" />
        <Registry Root="HKMU" 
          Key="Software\Microsoft\VisualStudio\8.0\AddIns\Ankh" 
          Name="AboutBoxDetails" Type="string" Value="$(var.aboutboxdetails)" />
      </Component>

      

      <Component Id="C_Ankh.dll" DiskId="1" Guid="02BBB6F8-8035-421f-83EC-7CA51E05B981">
        <File Id="CF_Ankh.dll" Name="Ankh.dll"
          Checksum="yes" KeyPath="yes" Vital="yes" src="$(var.builddir)\Ankh.dll" />
        <File Id="CF_Ankh.pdb" Name="Ankh.pdb" Checksum="yes" Vital="yes" src="$(var.builddir)\Ankh.pdb" />
      </Component>
      <Component Id="C_VS_SDK_License.rtf" DiskId="1" Guid="1D38A5AB-59FB-4564-8315-BF5799B978ED">
        <File Id="CF_VS_SDK_License.rtf" Name="VSSDKLIC.rtf" LongName="VS SDK License.rtf"
	  Checksum="yes" KeyPath="yes" Vital="yes" src="$(var.builddir)\..\..\VS SDK License.rtf" />
      </Component>

      <Directory Id="Ankh_directory1" Name="1033">
        <Component Id="C_Bitmap.dll" DiskId="1" Guid="B28F8ED5-4085-43A5-8ABF-FB1E7B8177E0">
          <File Id="Ankh_file3" Name="BITMAPDL.DLL" LongName="BitmapDll.dll" Checksum="yes" Vital="yes" src="$(var.builddir)\..\1033\BitmapDll.dll" />
        </Component>
      </Directory>
    </DirectoryRef>
  </Fragment>
</Wix>
